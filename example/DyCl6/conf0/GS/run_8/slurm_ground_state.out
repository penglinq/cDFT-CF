Currently Loaded Modulefiles:
 1) gmp/6.2.1-gcc-13.2.0-lcnhyse <aL>             
 2) mpfr/4.2.0-gcc-13.2.0-yy2fkq5 <aL>            
 3) mpc/1.3.1-gcc-13.2.0-5kgoftq <aL>             
 4) zlib-ng/2.1.3-gcc-13.2.0-jetnfwa <aL>         
 5) zstd/1.5.5-gcc-13.2.0-t2lua3l <aL>            
 6) gcc/13.2.0-gcc-13.2.0-w55nxkl                 
 7) cmake/3.20.2-gcc-13.2.0-rp74vpv               
 8) libfabric/1.18.1-gcc-13.2.0-bijxar4 <aL>      
 9) numactl/2.0.14-gcc-13.2.0-etkf74e <aL>        
10) openssh/8.7p1-gcc-13.2.0-g55xmkx <aL>         
11) slurm/22.05.6-gcc-13.2.0-tchsn6y <aL>         
12) openmpi/4.1.5-gcc-13.2.0-24q3ap2              
13) libpciaccess/0.17-gcc-13.2.0-r2cijnn <aL>     
14) libiconv/1.17-gcc-13.2.0-ntov4te <aL>         
15) xz/5.4.1-gcc-13.2.0-4xkm5xo <aL>              
16) libxml2/2.10.3-gcc-13.2.0-fr6jcjz <aL>        
17) ncurses/6.4-gcc-13.2.0-4o2yj6n <aL>           
18) hwloc/2.9.1-gcc-13.2.0-gzvfolk <aL>           
19) intel-tbb/2021.9.0-gcc-13.2.0-6nwk3ml <aL>    
20) intel-oneapi-mkl/2023.2.0-gcc-13.2.0-ohvyk7g  

Key:
<module-tag>  <aL>=auto-loaded  
/central/groups/changroup/members/lppeng/holmium/run/paper_final/run_Dy/conf7/GS/run_8
Tue Apr 15 10:54:09 PDT 2025
hpc-35-03.cm.cluster
--------------------------------------------------------------------------
WARNING: There is at least one non-excluded one OpenFabrics device found,
but there are no active ports detected (or Open MPI was unable to use
them).  This is most certainly not what you wanted.  Check your
cables, subnet manager configuration, etc.  The openib BTL will be
ignored for this job.

  Local host: hpc-35-03
--------------------------------------------------------------------------
Apr 15 10:54:12 ####### 
                ####### libDMET   version 0.5
                ####### A periodic DMET library for lattice model and realistic solid.
                ####### 
#INFO: **** input file is /central/groups/changroup/members/lppeng/holmium/run/paper_final/run_Dy/conf7/GS/run_8/ground_state.py ****
'''
Example input to calculate the ground state of a molecular system
Include x2c relativistic effect
'''
import pyscf
from pyscf.scf.hf import RHF
from pyscf.dft.uks import UKS
from pyscf.dft.gks import GKS
from pyscf import lib
import os, sys
import numpy as np
import scipy.linalg as la
from scipy.linalg import sqrtm, eigh
from scipy.optimize import root
np.set_printoptions(precision=12, threshold=sys.maxsize, linewidth=190, suppress=True)
log = lib.logger.Logger(sys.stdout, 4)

if __name__ == "__main__":
    from pyscf import gto, scf, dft, lib
    from pyscf.lib import chkfile
    from stevens import cdft, project, utils
    from stevens.project import get_mj

    # system input
    geometry = 'DyCl6' # The name of geometry file minus ".xyz"
                       # Make sure first atom is the central magnetic atom 
    spin = 5 # number of unpaired electrons in a unit cell
    charge = -3 # charge of the molecule or a unit cell
    basis = {'default': '631g', 'Dy': 'sarc-dkh'} # specify basis for all elements here
    max_memory = 32000 # in the unit of MB. Recommend: memory available on a node - 10000 MB
    qmmm = True # add environment with classical charges

    # (c)HF/DFT parameters
    xc = 'HF' # functional
    smearing = None # To help HF/DFT converge, try e.g. 5e-2
    chkfname_guess = 'project' # initial guess. 'minao' for default PySCF guess; None for constrained HF; 
                # path to a checkpoint file to restart from a SCF solution.
                # 'project' to project from the SCF solution in a small basis to generate the initial guess
    chkfname_small = '../gs_small_%s.chk'%geometry # checkpoint file in a small basis. Used when chkfname_guess == 'project'
    basis_small = {'default': 'minao', 'Dy': 'cc-x2c-minao'}# the small basis associated with chkfname_small
    change_dm_mode = 'rotate' # None: no change
                          # 'positive_z': set the 4f block of dm so that J~(0,0,J)
                          # 'rotate': rotate the 4f block of dm by some angles
    atom_index = 0 # the index of central lanthanide atom
    occ_idx = 8
    noise = 0 # max noise on density matrix initial guess

    # constrained HF parameters for the initial guess
    ao_shell = 'f'
    lo_chkfname = '../../UHF/uhf_gs_%s_lo.h5'%geometry  
    multiplier0 = 0.1
    # END USER INPUT

    # set up system
    if os.path.isfile('../../' + geometry + ".xyz"):
        mol = gto.M(
            atom = '../../' + geometry + ".xyz",
            basis = basis,
            verbose = 4,
            spin = spin,
            charge = charge,
            max_memory = max_memory,
            )
        mol.set_common_origin(mol._atom[atom_index][1])
    else:
        raise ValueError("No .xyz file available!")
    log.info("N_elec %s, N_ao %s"%(mol.nelec, mol.nao))

    # generate HF/DFT initial guess
    if chkfname_guess == 'minao':
        mf = scf.GKS(mol).x2c()
        dm0 = mf.get_init_guess()
        print("Use PySCF default init guess")
    elif chkfname_guess is None:
        # run constrained DFT
        angles = cdft.sample_rotation('xyz', occ_idx, unit=20)
        from scipy.spatial.transform import Rotation
        direction = Rotation.from_euler('zyz', angles, degrees=False) @ [0,0,1]
        cmf = cdft.CGKS(mol, direction, multiplier_guess=multiplier0, max_cycle=300,
                atom_index=atom_index, ao_shell='f', lo_chkfname=lo_chkfname, xc=xc, smearing=smearing)
        cmf.kernel()
        dm0 = cmf._scf.make_rdm1()
        print("Contrained SCF solution as init guess")
    elif chkfname_guess == 'project':
        # project dm0 in a small basis to the larger basis 
        dm0 = utils.project_dm_from_small_basis(mol, basis_small, chkfname_small, change_dm_mode, atom_index=atom_index, occ_idx=occ_idx)
        print("Project wavefunction in a smaller basis to the target basis as init guess")
    else:
        mf = scf.GKS(mol).x2c()
        data = chkfile.load(chkfname_guess, 'scf')
        mf.__dict__.update(data)
        dm0 = mf.make_rdm1()
        mf.analyze(with_meta_lowdin=False)
        print("Load .chk file for init guess")
    if change_dm_mode is not None and not chkfname_guess == 'project': # when chkfname_guess == 'project', change in small basis
        dm0 = utils.change_dm_guess(mol, dm0, change_dm_mode, atom_index=atom_index, occ_idx=occ_idx)
    dm0 += (np.random.rand(*(dm0.shape)) - 0.5) * noise  
    print("J vector of initial guess", get_mj(mol, dm0, analyze=True))

    # run HF/DFT
    mf = scf.GKS(mol).x2c()
    mf.xc = xc
    if xc.upper() != 'HF':
        mf.collinear = 'mcol'
        mf.grids.level = 6 
    mf.chkfile = 'gs_' + geometry + '.chk' 
    mf.max_cycle = 1000 
    if smearing is not None:
        mf = scf.addons.smearing_(mf, sigma=smearing, method="fermi")
    if qmmm: # add the precomputed potential from environmental classical charges 
        get_hcore_original = mf.get_hcore
        hcore_mm = np.load('../../mm_hcore.npy')
        def get_hcore_mm(self, mol=None):
            return get_hcore_original(mol=mol) + la.block_diag(hcore_mm, hcore_mm)
        import types
        mf.get_hcore = types.MethodType(get_hcore_mm, mf)
    mf.kernel(dm0=dm0)
    dm = mf.make_rdm1()
    print("S vector", get_mj(mol, dm, include_L=False))
    print("L vector", get_mj(mol, dm, include_S=False))
    print("J vector", get_mj(mol, dm))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-35-03.cm.cluster', release='5.14.0-362.24.1.el9_3.x86_64', version='#1 SMP PREEMPT_DYNAMIC Thu Feb 15 07:18:13 EST 2024', machine='x86_64')  Threads 8
Python 3.11.6 | packaged by conda-forge | (main, Oct  3 2023, 10:40:35) [GCC 12.3.0]
numpy 1.26.0  scipy 1.11.3
Date: Tue Apr 15 10:54:14 2025
PySCF version 2.5.0
PySCF path  /home/lppeng/anaconda3/envs/nerscV25/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 7
[INPUT] num. electrons = 171
[INPUT] charge = -3
[INPUT] spin (= nelec alpha-beta = 2S) = 5
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 Dy     0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 Cl     2.724000000000   0.000000000000   0.000000000000 AA    5.147613963315   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  3 Cl    -2.724000000000   0.000000000000   0.000000000000 AA   -5.147613963315   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  4 Cl     0.000000000000   2.724000000000   0.000000000000 AA    0.000000000000   5.147613963315   0.000000000000 Bohr   0.0
[INPUT]  5 Cl     0.000000000000  -2.724000000000   0.000000000000 AA    0.000000000000  -5.147613963315   0.000000000000 Bohr   0.0
[INPUT]  6 Cl     0.000000000000   0.000000000000   2.724000000000 AA    0.000000000000   0.000000000000   5.147613963315 Bohr   0.0
[INPUT]  7 Cl     0.000000000000   0.000000000000  -2.724000000000 AA    0.000000000000   0.000000000000  -5.147613963315 Bohr   0.0

nuclear repulsion = 1868.38919656687
number of shells = 84
number of NR pGTOs = 449
number of NR cGTOs = 198
basis = {'default': '631g', 'Dy': 'sarc-dkh'}
ecp = {}
CPU time:         3.54
N_elec (88, 83), N_ao 198
#INFO: **** input file is /central/groups/changroup/members/lppeng/holmium/run/paper_final/run_Dy/conf7/GS/run_8/ground_state.py ****
'''
Example input to calculate the ground state of a molecular system
Include x2c relativistic effect
'''
import pyscf
from pyscf.scf.hf import RHF
from pyscf.dft.uks import UKS
from pyscf.dft.gks import GKS
from pyscf import lib
import os, sys
import numpy as np
import scipy.linalg as la
from scipy.linalg import sqrtm, eigh
from scipy.optimize import root
np.set_printoptions(precision=12, threshold=sys.maxsize, linewidth=190, suppress=True)
log = lib.logger.Logger(sys.stdout, 4)

if __name__ == "__main__":
    from pyscf import gto, scf, dft, lib
    from pyscf.lib import chkfile
    from stevens import cdft, project, utils
    from stevens.project import get_mj

    # system input
    geometry = 'DyCl6' # The name of geometry file minus ".xyz"
                       # Make sure first atom is the central magnetic atom 
    spin = 5 # number of unpaired electrons in a unit cell
    charge = -3 # charge of the molecule or a unit cell
    basis = {'default': '631g', 'Dy': 'sarc-dkh'} # specify basis for all elements here
    max_memory = 32000 # in the unit of MB. Recommend: memory available on a node - 10000 MB
    qmmm = True # add environment with classical charges

    # (c)HF/DFT parameters
    xc = 'HF' # functional
    smearing = None # To help HF/DFT converge, try e.g. 5e-2
    chkfname_guess = 'project' # initial guess. 'minao' for default PySCF guess; None for constrained HF; 
                # path to a checkpoint file to restart from a SCF solution.
                # 'project' to project from the SCF solution in a small basis to generate the initial guess
    chkfname_small = '../gs_small_%s.chk'%geometry # checkpoint file in a small basis. Used when chkfname_guess == 'project'
    basis_small = {'default': 'minao', 'Dy': 'cc-x2c-minao'}# the small basis associated with chkfname_small
    change_dm_mode = 'rotate' # None: no change
                          # 'positive_z': set the 4f block of dm so that J~(0,0,J)
                          # 'rotate': rotate the 4f block of dm by some angles
    atom_index = 0 # the index of central lanthanide atom
    occ_idx = 8
    noise = 0 # max noise on density matrix initial guess

    # constrained HF parameters for the initial guess
    ao_shell = 'f'
    lo_chkfname = '../../UHF/uhf_gs_%s_lo.h5'%geometry  
    multiplier0 = 0.1
    # END USER INPUT

    # set up system
    if os.path.isfile('../../' + geometry + ".xyz"):
        mol = gto.M(
            atom = '../../' + geometry + ".xyz",
            basis = basis,
            verbose = 4,
            spin = spin,
            charge = charge,
            max_memory = max_memory,
            )
        mol.set_common_origin(mol._atom[atom_index][1])
    else:
        raise ValueError("No .xyz file available!")
    log.info("N_elec %s, N_ao %s"%(mol.nelec, mol.nao))

    # generate HF/DFT initial guess
    if chkfname_guess == 'minao':
        mf = scf.GKS(mol).x2c()
        dm0 = mf.get_init_guess()
        print("Use PySCF default init guess")
    elif chkfname_guess is None:
        # run constrained DFT
        angles = cdft.sample_rotation('xyz', occ_idx, unit=20)
        from scipy.spatial.transform import Rotation
        direction = Rotation.from_euler('zyz', angles, degrees=False) @ [0,0,1]
        cmf = cdft.CGKS(mol, direction, multiplier_guess=multiplier0, max_cycle=300,
                atom_index=atom_index, ao_shell='f', lo_chkfname=lo_chkfname, xc=xc, smearing=smearing)
        cmf.kernel()
        dm0 = cmf._scf.make_rdm1()
        print("Contrained SCF solution as init guess")
    elif chkfname_guess == 'project':
        # project dm0 in a small basis to the larger basis 
        dm0 = utils.project_dm_from_small_basis(mol, basis_small, chkfname_small, change_dm_mode, atom_index=atom_index, occ_idx=occ_idx)
        print("Project wavefunction in a smaller basis to the target basis as init guess")
    else:
        mf = scf.GKS(mol).x2c()
        data = chkfile.load(chkfname_guess, 'scf')
        mf.__dict__.update(data)
        dm0 = mf.make_rdm1()
        mf.analyze(with_meta_lowdin=False)
        print("Load .chk file for init guess")
    if change_dm_mode is not None and not chkfname_guess == 'project': # when chkfname_guess == 'project', change in small basis
        dm0 = utils.change_dm_guess(mol, dm0, change_dm_mode, atom_index=atom_index, occ_idx=occ_idx)
    dm0 += (np.random.rand(*(dm0.shape)) - 0.5) * noise  
    print("J vector of initial guess", get_mj(mol, dm0, analyze=True))

    # run HF/DFT
    mf = scf.GKS(mol).x2c()
    mf.xc = xc
    if xc.upper() != 'HF':
        mf.collinear = 'mcol'
        mf.grids.level = 6 
    mf.chkfile = 'gs_' + geometry + '.chk' 
    mf.max_cycle = 1000 
    if smearing is not None:
        mf = scf.addons.smearing_(mf, sigma=smearing, method="fermi")
    if qmmm: # add the precomputed potential from environmental classical charges 
        get_hcore_original = mf.get_hcore
        hcore_mm = np.load('../../mm_hcore.npy')
        def get_hcore_mm(self, mol=None):
            return get_hcore_original(mol=mol) + la.block_diag(hcore_mm, hcore_mm)
        import types
        mf.get_hcore = types.MethodType(get_hcore_mm, mf)
    mf.kernel(dm0=dm0)
    dm = mf.make_rdm1()
    print("S vector", get_mj(mol, dm, include_L=False))
    print("L vector", get_mj(mol, dm, include_S=False))
    print("J vector", get_mj(mol, dm))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-35-03.cm.cluster', release='5.14.0-362.24.1.el9_3.x86_64', version='#1 SMP PREEMPT_DYNAMIC Thu Feb 15 07:18:13 EST 2024', machine='x86_64')  Threads 8
Python 3.11.6 | packaged by conda-forge | (main, Oct  3 2023, 10:40:35) [GCC 12.3.0]
numpy 1.26.0  scipy 1.11.3
Date: Tue Apr 15 10:54:14 2025
PySCF version 2.5.0
PySCF path  /home/lppeng/anaconda3/envs/nerscV25/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 7
[INPUT] num. electrons = 171
[INPUT] charge = -3
[INPUT] spin (= nelec alpha-beta = 2S) = 5
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 Dy     0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 Cl     2.724000000000   0.000000000000   0.000000000000 AA    5.147613963315   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  3 Cl    -2.724000000000   0.000000000000   0.000000000000 AA   -5.147613963315   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  4 Cl     0.000000000000   2.724000000000   0.000000000000 AA    0.000000000000   5.147613963315   0.000000000000 Bohr   0.0
[INPUT]  5 Cl     0.000000000000  -2.724000000000   0.000000000000 AA    0.000000000000  -5.147613963315   0.000000000000 Bohr   0.0
[INPUT]  6 Cl     0.000000000000   0.000000000000   2.724000000000 AA    0.000000000000   0.000000000000   5.147613963315 Bohr   0.0
[INPUT]  7 Cl     0.000000000000   0.000000000000  -2.724000000000 AA    0.000000000000   0.000000000000  -5.147613963315 Bohr   0.0

nuclear repulsion = 1868.38919656687
number of shells = 16
number of NR pGTOs = 511
number of NR cGTOs = 89
basis = {'default': 'minao', 'Dy': 'cc-x2c-minao'}
ecp = {}
CPU time:         3.75
basis {'default': '631g', 'Dy': 'sarc-dkh'} 198
basis {'default': 'minao', 'Dy': 'cc-x2c-minao'} 89
(3, 89, 89) 89
Haar random target direction [0.5877852522924732, 0.0, -0.8090169943749473]
Haar random total rotation [0.     2.5133 0.    ]
Rotated f-block dm by angles from +z [0.     2.5133 0.    ]
Project wavefunction in a smaller basis to the target basis as init guess
(3, 198, 198) 198
elemental J of ['Cl' 'Dy']
  Cl -0.0003+0.0000j 0.0000+0.0000j 0.0317-0.0000j 
  Dy 4.3840-0.0000j 0.0000+0.0000j -6.0509+0.0000j 
J vector of initial guess [ 4.3836-0.j -0.    -0.j -6.0193+0.j]


******** <class 'pyscf.x2c.x2c.X2C1eGKS'> ********
method = X2C1eGKS
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 1000
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = gs_DyCl6.chk
max_memory 32000 MB (current use 159 MB)
XC library pyscf.dft.libxc version 6.1.0
    S. Lehtola, C. Steigemann, M. J.T. Oliveira, and M. A.L. Marques.,  SoftwareX 7, 1â€“5 (2018)
XC functionals = HF

radial grids: 
    Treutler-Ahlrichs [JCP 102, 346 (1995); DOI:10.1063/1.469408] (M4) radial grids
    
becke partition: Becke, JCP 88, 2547 (1988); DOI:10.1063/1.454033
pruning grids: <function nwchem_prune at 0x7fdbbac61e40>
grids dens level: 3
symmetrized grids: False
atomic radii adjust function: <function treutler_atomic_radii_adjust at 0x7fdbbac62480>
small_rho_cutoff = 1e-07
collinear = col


******** <class 'pyscf.x2c.x2c.SpinOrbitalX2CHelper'> ********
approx = 1e
xuncontract = 1
Overwritten attributes  get_hcore  of <class 'pyscf.x2c.x2c.X2C1eGKS'>
Set gradient conv threshold to 3.16228e-05
tot grids = 134432
init E= -14971.0845253827
  HOMO = -0.282817396748681  LUMO = -0.0680499113088513
cycle= 1 E= -14978.618238884  delta_E= -7.53  |g|= 1.61  |ddm|= 2.42
  HOMO = -0.307766659461762  LUMO = 0.124180263340853
cycle= 2 E= -14978.7149609592  delta_E= -0.0967  |g|= 0.638  |ddm|= 1.09
  HOMO = -0.322361170333941  LUMO = 0.122262433426382
cycle= 3 E= -14978.7607564653  delta_E= -0.0458  |g|= 0.271  |ddm|= 0.494
  HOMO = -0.322579178594334  LUMO = 0.122630652864859
cycle= 4 E= -14978.7665846475  delta_E= -0.00583  |g|= 0.0198  |ddm|= 0.0912
  HOMO = -0.323825986759472  LUMO = 0.12281798648114
cycle= 5 E= -14978.7667681958  delta_E= -0.000184  |g|= 0.00613  |ddm|= 0.0235
  HOMO = -0.323683676733004  LUMO = 0.122824787639813
cycle= 6 E= -14978.7668297346  delta_E= -6.15e-05  |g|= 0.00498  |ddm|= 0.0103
  HOMO = -0.323723972240842  LUMO = 0.122833201926189
cycle= 7 E= -14978.7669277164  delta_E= -9.8e-05  |g|= 0.00353  |ddm|= 0.0165
  HOMO = -0.323632218415088  LUMO = 0.122830835646317
cycle= 8 E= -14978.7670130857  delta_E= -8.54e-05  |g|= 0.00139  |ddm|= 0.0261
  HOMO = -0.323711957072175  LUMO = 0.122827690220025
cycle= 9 E= -14978.7670225154  delta_E= -9.43e-06  |g|= 0.000684  |ddm|= 0.0091
  HOMO = -0.323694546500452  LUMO = 0.122826511712682
cycle= 10 E= -14978.767023826  delta_E= -1.31e-06  |g|= 0.00054  |ddm|= 0.0021
  HOMO = -0.323692927532708  LUMO = 0.122826608569596
cycle= 11 E= -14978.7670250154  delta_E= -1.19e-06  |g|= 0.000454  |ddm|= 0.00184
  HOMO = -0.323692596183135  LUMO = 0.122827046461646
cycle= 12 E= -14978.7670261611  delta_E= -1.15e-06  |g|= 0.000404  |ddm|= 0.00189
  HOMO = -0.323692852448249  LUMO = 0.122826539087513
cycle= 13 E= -14978.7670273175  delta_E= -1.16e-06  |g|= 0.000372  |ddm|= 0.00212
  HOMO = -0.323693653921904  LUMO = 0.122826776136619
cycle= 14 E= -14978.7670283647  delta_E= -1.05e-06  |g|= 0.000348  |ddm|= 0.00207
  HOMO = -0.323692030824085  LUMO = 0.122827020020744
cycle= 15 E= -14978.7670299262  delta_E= -1.56e-06  |g|= 0.000311  |ddm|= 0.0034
  HOMO = -0.323690219496137  LUMO = 0.122826811596346
cycle= 16 E= -14978.7670324404  delta_E= -2.51e-06  |g|= 0.000251  |ddm|= 0.00685
  HOMO = -0.323691811058987  LUMO = 0.122826927384129
cycle= 17 E= -14978.7670334436  delta_E= -1e-06  |g|= 0.000231  |ddm|= 0.00357
  HOMO = -0.32368927124713  LUMO = 0.122826539252898
cycle= 18 E= -14978.7670338671  delta_E= -4.24e-07  |g|= 0.000222  |ddm|= 0.00156
  HOMO = -0.323690202470182  LUMO = 0.122826375864761
cycle= 19 E= -14978.7670344337  delta_E= -5.67e-07  |g|= 0.00021  |ddm|= 0.00205
  HOMO = -0.323689287492813  LUMO = 0.122826539301285
cycle= 20 E= -14978.7670349422  delta_E= -5.09e-07  |g|= 0.000202  |ddm|= 0.0019
  HOMO = -0.323687694667175  LUMO = 0.122826360673517
cycle= 21 E= -14978.7670353268  delta_E= -3.85e-07  |g|= 0.000197  |ddm|= 0.00144
  HOMO = -0.323688814212427  LUMO = 0.122826349260584
cycle= 22 E= -14978.7670358638  delta_E= -5.37e-07  |g|= 0.00019  |ddm|= 0.00203
  HOMO = -0.323687193304196  LUMO = 0.122826094881779
cycle= 23 E= -14978.7670364222  delta_E= -5.58e-07  |g|= 0.000186  |ddm|= 0.00218
  HOMO = -0.323686745852166  LUMO = 0.122825967231592
cycle= 24 E= -14978.7670367273  delta_E= -3.05e-07  |g|= 0.000184  |ddm|= 0.00119
  HOMO = -0.323686750271605  LUMO = 0.122826016760633
cycle= 25 E= -14978.7670370309  delta_E= -3.04e-07  |g|= 0.000183  |ddm|= 0.00117
  HOMO = -0.323685854188253  LUMO = 0.122825988092169
cycle= 26 E= -14978.7670372643  delta_E= -2.33e-07  |g|= 0.000182  |ddm|= 0.000897
  HOMO = -0.323686027167788  LUMO = 0.122825983135531
cycle= 27 E= -14978.7670374066  delta_E= -1.42e-07  |g|= 0.000182  |ddm|= 0.000544
  HOMO = -0.323685954453725  LUMO = 0.122825976235706
cycle= 28 E= -14978.7670374891  delta_E= -8.25e-08  |g|= 0.000182  |ddm|= 0.000315
  HOMO = -0.323685870574212  LUMO = 0.122825971525942
cycle= 29 E= -14978.7670375389  delta_E= -4.98e-08  |g|= 0.000182  |ddm|= 0.00019
  HOMO = -0.323685925212204  LUMO = 0.122825972017069
cycle= 30 E= -14978.7670375041  delta_E= 3.49e-08  |g|= 0.000182  |ddm|= 0.000135
  HOMO = -0.32368603588081  LUMO = 0.122825970922343
cycle= 31 E= -14978.7670374341  delta_E= 6.99e-08  |g|= 0.000182  |ddm|= 0.000273
  HOMO = -0.323686038143382  LUMO = 0.122825972615349
cycle= 32 E= -14978.7670374304  delta_E= 3.72e-09  |g|= 0.000182  |ddm|= 1.51e-05
  HOMO = -0.323686040229049  LUMO = 0.122825973642168
cycle= 33 E= -14978.7670374317  delta_E= -1.27e-09  |g|= 0.000182  |ddm|= 1.55e-05
  HOMO = -0.323686047611285  LUMO = 0.122825973111201
cycle= 34 E= -14978.7670374274  delta_E= 4.27e-09  |g|= 0.000182  |ddm|= 2.16e-05
  HOMO = -0.323686018646729  LUMO = 0.122825972393796
cycle= 35 E= -14978.7670374366  delta_E= -9.24e-09  |g|= 0.000182  |ddm|= 4.18e-05
  HOMO = -0.323686008061611  LUMO = 0.122825970830276
cycle= 36 E= -14978.7670374529  delta_E= -1.63e-08  |g|= 0.000182  |ddm|= 6.84e-05
  HOMO = -0.323686014464817  LUMO = 0.122825966268867
cycle= 37 E= -14978.7670374821  delta_E= -2.92e-08  |g|= 0.000182  |ddm|= 0.000113
  HOMO = -0.323685974604396  LUMO = 0.122825970238901
cycle= 38 E= -14978.7670375061  delta_E= -2.4e-08  |g|= 0.000182  |ddm|= 9.15e-05
  HOMO = -0.323686057014283  LUMO = 0.122825963385912
cycle= 39 E= -14978.767037429  delta_E= 7.71e-08  |g|= 0.000182  |ddm|= 0.000294
  HOMO = -0.323686340662467  LUMO = 0.122825964857551
cycle= 40 E= -14978.7670371434  delta_E= 2.86e-07  |g|= 0.000182  |ddm|= 0.00109
  HOMO = -0.323686597801529  LUMO = 0.122825960238906
cycle= 41 E= -14978.7670368633  delta_E= 2.8e-07  |g|= 0.000182  |ddm|= 0.00107
  HOMO = -0.323686861145995  LUMO = 0.122825956038145
cycle= 42 E= -14978.7670366288  delta_E= 2.35e-07  |g|= 0.000182  |ddm|= 0.000898
  HOMO = -0.323687951778083  LUMO = 0.122825871689306
cycle= 43 E= -14978.7670355911  delta_E= 1.04e-06  |g|= 0.000181  |ddm|= 0.004
  HOMO = -0.323688935648491  LUMO = 0.122825769670504
cycle= 44 E= -14978.767034409  delta_E= 1.18e-06  |g|= 0.00018  |ddm|= 0.00461
  HOMO = -0.323689628090587  LUMO = 0.1228257210677
cycle= 45 E= -14978.7670335767  delta_E= 8.32e-07  |g|= 0.00018  |ddm|= 0.00328
  HOMO = -0.323690917258505  LUMO = 0.122825649351728
cycle= 46 E= -14978.7670320824  delta_E= 1.49e-06  |g|= 0.000178  |ddm|= 0.00594
  HOMO = -0.323695571306625  LUMO = 0.122825447138352
cycle= 47 E= -14978.7670275569  delta_E= 4.53e-06  |g|= 0.000176  |ddm|= 0.0185
  HOMO = -0.323696800065429  LUMO = 0.122825391371727
cycle= 48 E= -14978.7670265408  delta_E= 1.02e-06  |g|= 0.000174  |ddm|= 0.00426
  HOMO = -0.323708201297246  LUMO = 0.122824966773569
cycle= 49 E= -14978.7670166448  delta_E= 9.9e-06  |g|= 0.000321  |ddm|= 0.0433
  HOMO = -0.32370886171717  LUMO = 0.122824936806924
cycle= 50 E= -14978.7670160874  delta_E= 5.57e-07  |g|= 0.000334  |ddm|= 0.00249
  HOMO = -0.323704378380445  LUMO = 0.122825053351622
cycle= 51 E= -14978.767019895  delta_E= -3.81e-06  |g|= 0.000197  |ddm|= 0.0169
  HOMO = -0.323707512554245  LUMO = 0.12282493601742
cycle= 52 E= -14978.7670171201  delta_E= 2.77e-06  |g|= 0.000238  |ddm|= 0.0127
  HOMO = -0.323705478179345  LUMO = 0.122825081802807
cycle= 53 E= -14978.7670189535  delta_E= -1.83e-06  |g|= 0.000181  |ddm|= 0.00834
  HOMO = -0.323706118383326  LUMO = 0.122825084580604
cycle= 54 E= -14978.7670183713  delta_E= 5.82e-07  |g|= 0.000185  |ddm|= 0.00268
  HOMO = -0.323705477690131  LUMO = 0.122825151070335
cycle= 55 E= -14978.767019017  delta_E= -6.46e-07  |g|= 0.000174  |ddm|= 0.00293
  HOMO = -0.323703845249048  LUMO = 0.122825226767858
cycle= 56 E= -14978.7670203756  delta_E= -1.36e-06  |g|= 0.000162  |ddm|= 0.00611
  HOMO = -0.323703545003412  LUMO = 0.122825237279178
cycle= 57 E= -14978.7670206625  delta_E= -2.87e-07  |g|= 0.00016  |ddm|= 0.00131
  HOMO = -0.323705200942554  LUMO = 0.12282508775118
cycle= 58 E= -14978.7670188534  delta_E= 1.81e-06  |g|= 0.000157  |ddm|= 0.00817
  HOMO = -0.323710797001015  LUMO = 0.122824759373457
cycle= 59 E= -14978.7670142232  delta_E= 4.63e-06  |g|= 0.000184  |ddm|= 0.0217
  HOMO = -0.323711188477621  LUMO = 0.122824724634378
cycle= 60 E= -14978.7670138252  delta_E= 3.98e-07  |g|= 0.000169  |ddm|= 0.00202
  HOMO = -0.323711270430117  LUMO = 0.12282472304083
cycle= 61 E= -14978.7670136655  delta_E= 1.6e-07  |g|= 0.000154  |ddm|= 0.000986
  HOMO = -0.323716903200525  LUMO = 0.12282451507135
cycle= 62 E= -14978.7670092961  delta_E= 4.37e-06  |g|= 0.00026  |ddm|= 0.0219
  HOMO = -0.323719908220882  LUMO = 0.122824268852089
cycle= 63 E= -14978.7670069295  delta_E= 2.37e-06  |g|= 0.000482  |ddm|= 0.0122
  HOMO = -0.323719592585863  LUMO = 0.122824643703016
cycle= 64 E= -14978.7670074707  delta_E= -5.41e-07  |g|= 0.000313  |ddm|= 0.00283
  HOMO = -0.323718273997095  LUMO = 0.122824622335148
cycle= 65 E= -14978.7670082971  delta_E= -8.26e-07  |g|= 0.000288  |ddm|= 0.00434
  HOMO = -0.323719120600868  LUMO = 0.122824510322638
cycle= 66 E= -14978.7670075889  delta_E= 7.08e-07  |g|= 0.000326  |ddm|= 0.00374
  HOMO = -0.323712956038176  LUMO = 0.122824884272264
cycle= 67 E= -14978.7670125905  delta_E= -5e-06  |g|= 0.000153  |ddm|= 0.0256
  HOMO = -0.323713334178987  LUMO = 0.122824862689103
cycle= 68 E= -14978.7670123102  delta_E= 2.8e-07  |g|= 0.000157  |ddm|= 0.00138
  HOMO = -0.323713578962804  LUMO = 0.122824832198154
cycle= 69 E= -14978.767012081  delta_E= 2.29e-07  |g|= 0.000144  |ddm|= 0.0013
  HOMO = -0.323717134497253  LUMO = 0.12282463474385
cycle= 70 E= -14978.7670090774  delta_E= 3e-06  |g|= 0.000138  |ddm|= 0.0153
  HOMO = -0.323721433574462  LUMO = 0.122824402560012
cycle= 71 E= -14978.767005895  delta_E= 3.18e-06  |g|= 0.000154  |ddm|= 0.0171
  HOMO = -0.323721150858523  LUMO = 0.122824429163505
cycle= 72 E= -14978.7670060769  delta_E= -1.82e-07  |g|= 0.000133  |ddm|= 0.001
  HOMO = -0.323723477343325  LUMO = 0.122824275671474
cycle= 73 E= -14978.7670042153  delta_E= 1.86e-06  |g|= 0.000163  |ddm|= 0.0104
  HOMO = -0.323724208830529  LUMO = 0.122824239185414
cycle= 74 E= -14978.7670036295  delta_E= 5.86e-07  |g|= 0.000128  |ddm|= 0.00336
  HOMO = -0.323725980272403  LUMO = 0.122824095863011
cycle= 75 E= -14978.7670021874  delta_E= 1.44e-06  |g|= 0.000141  |ddm|= 0.00836
  HOMO = -0.323725857834534  LUMO = 0.122824110252277
cycle= 76 E= -14978.7670022874  delta_E= -1e-07  |g|= 0.000134  |ddm|= 0.000588
  HOMO = -0.323727253736119  LUMO = 0.122824063337582
cycle= 77 E= -14978.7670011962  delta_E= 1.09e-06  |g|= 0.000146  |ddm|= 0.00649
  HOMO = -0.323727057913598  LUMO = 0.122824074865556
cycle= 78 E= -14978.7670013382  delta_E= -1.42e-07  |g|= 0.000145  |ddm|= 0.000847
  HOMO = -0.323725092764945  LUMO = 0.122824213736032
cycle= 79 E= -14978.7670028984  delta_E= -1.56e-06  |g|= 0.000135  |ddm|= 0.00916
  HOMO = -0.323725562450697  LUMO = 0.122824197071451
cycle= 80 E= -14978.7670025845  delta_E= 3.14e-07  |g|= 0.000131  |ddm|= 0.0018
  HOMO = -0.32372518566773  LUMO = 0.122824206117408
cycle= 81 E= -14978.7670028603  delta_E= -2.76e-07  |g|= 0.000124  |ddm|= 0.00172
  HOMO = -0.32372915153105  LUMO = 0.122824014272673
cycle= 82 E= -14978.7669999443  delta_E= 2.92e-06  |g|= 0.000122  |ddm|= 0.0175
  HOMO = -0.323730777082346  LUMO = 0.122823959747747
cycle= 83 E= -14978.7669987492  delta_E= 1.2e-06  |g|= 0.000117  |ddm|= 0.00755
  HOMO = -0.323733216305405  LUMO = 0.122823921657175
cycle= 84 E= -14978.7669970833  delta_E= 1.67e-06  |g|= 0.000113  |ddm|= 0.0109
  HOMO = -0.323737150551042  LUMO = 0.12282382194128
cycle= 85 E= -14978.7669942096  delta_E= 2.87e-06  |g|= 0.000109  |ddm|= 0.0202
  HOMO = -0.323740614401835  LUMO = 0.122823836576758
cycle= 86 E= -14978.7669921492  delta_E= 2.06e-06  |g|= 0.000103  |ddm|= 0.0157
  HOMO = -0.323744286759812  LUMO = 0.122823759206418
cycle= 87 E= -14978.7669898159  delta_E= 2.33e-06  |g|= 0.00012  |ddm|= 0.0192
  HOMO = -0.323744469738642  LUMO = 0.122823840212571
cycle= 88 E= -14978.7669897269  delta_E= 8.9e-08  |g|= 0.000125  |ddm|= 0.000925
  HOMO = -0.323748723137944  LUMO = 0.122823596041906
cycle= 89 E= -14978.766986893  delta_E= 2.83e-06  |g|= 0.000466  |ddm|= 0.0257
  HOMO = -0.323748075742212  LUMO = 0.122823791726138
cycle= 90 E= -14978.7669873686  delta_E= -4.76e-07  |g|= 8.38e-05  |ddm|= 0.00389
  HOMO = -0.323751255139784  LUMO = 0.122823723420482
cycle= 91 E= -14978.7669847817  delta_E= 2.59e-06  |g|= 9.15e-05  |ddm|= 0.0286
  HOMO = -0.323752529499058  LUMO = 0.122823715119407
cycle= 92 E= -14978.7669836294  delta_E= 1.15e-06  |g|= 9.02e-05  |ddm|= 0.0151
  HOMO = -0.323753014605332  LUMO = 0.122823699003403
cycle= 93 E= -14978.7669825426  delta_E= 1.09e-06  |g|= 5.8e-05  |ddm|= 0.0165
  HOMO = -0.323753131479382  LUMO = 0.122823654655358
cycle= 94 E= -14978.7669816344  delta_E= 9.08e-07  |g|= 5.86e-05  |ddm|= 0.0164
  HOMO = -0.323752540730837  LUMO = 0.122823614786503
cycle= 95 E= -14978.7669810389  delta_E= 5.95e-07  |g|= 4.39e-05  |ddm|= 0.0132
  HOMO = -0.323751715417311  LUMO = 0.12282353896245
cycle= 96 E= -14978.7669807506  delta_E= 2.88e-07  |g|= 4.6e-05  |ddm|= 0.00755
  HOMO = -0.323751469604012  LUMO = 0.12282349532395
cycle= 97 E= -14978.7669806347  delta_E= 1.16e-07  |g|= 3.87e-05  |ddm|= 0.00341
  HOMO = -0.32375095246182  LUMO = 0.122823423317297
cycle= 98 E= -14978.7669804704  delta_E= 1.64e-07  |g|= 7.74e-05  |ddm|= 0.00484
  HOMO = -0.323750954293223  LUMO = 0.122823436042721
cycle= 99 E= -14978.7669804833  delta_E= -1.3e-08  |g|= 3.14e-05  |ddm|= 0.000349
  HOMO = -0.323750855842142  LUMO = 0.122823417014725
cycle= 100 E= -14978.7669804851  delta_E= -1.76e-09  |g|= 4.22e-05  |ddm|= 0.00033
  HOMO = -0.323750463394815  LUMO = 0.122823373097922
cycle= 101 E= -14978.7669803827  delta_E= 1.02e-07  |g|= 3.29e-05  |ddm|= 0.0034
  HOMO = -0.323750115315747  LUMO = 0.122823365703108
cycle= 102 E= -14978.766980264  delta_E= 1.19e-07  |g|= 2.38e-05  |ddm|= 0.00436
  HOMO = -0.323749507381419  LUMO = 0.122823355661622
cycle= 103 E= -14978.7669801571  delta_E= 1.07e-07  |g|= 2e-05  |ddm|= 0.00433
  HOMO = -0.32374906585046  LUMO = 0.122823355939166
cycle= 104 E= -14978.7669800593  delta_E= 9.79e-08  |g|= 1.85e-05  |ddm|= 0.00448
  HOMO = -0.323748361027072  LUMO = 0.122823342973652
cycle= 105 E= -14978.7669799768  delta_E= 8.24e-08  |g|= 1.65e-05  |ddm|= 0.00437
  HOMO = -0.323747882328138  LUMO = 0.122823345190292
cycle= 106 E= -14978.7669799265  delta_E= 5.03e-08  |g|= 1.53e-05  |ddm|= 0.00307
  HOMO = -0.323747174497874  LUMO = 0.122823355812107
cycle= 107 E= -14978.7669798599  delta_E= 6.66e-08  |g|= 1.33e-05  |ddm|= 0.00484
  HOMO = -0.323746668830555  LUMO = 0.122823368590881
cycle= 108 E= -14978.7669798202  delta_E= 3.97e-08  |g|= 1.21e-05  |ddm|= 0.00361
  HOMO = -0.323746453838132  LUMO = 0.122823383679296
cycle= 109 E= -14978.7669798038  delta_E= 1.64e-08  |g|= 1.21e-05  |ddm|= 0.00184
  HOMO = -0.3237464240988  LUMO = 0.122823379962617
cycle= 110 E= -14978.7669798044  delta_E= -5.89e-10  |g|= 1.12e-05  |ddm|= 6.27e-05
  HOMO = -0.323746457421249  LUMO = 0.12282337966602
Extra cycle  E= -14978.7669798045  delta_E= -1.82e-10  |g|= 1.03e-05  |ddm|= 1.14e-05
converged SCF energy = -14978.7669798045  <S^2> = 8.2685299  2S+1 = 5.8373041
(3, 198, 198) 198
S vector [ 1.6786-0.j  0.    -0.j -1.6916-0.j]
(3, 198, 198) 198
L vector [ 3.601 -0.j  0.    -0.j -3.6314+0.j]
(3, 198, 198) 198
J vector [ 5.2796-0.j  0.    -0.j -5.323 +0.j]
Tue Apr 15 10:56:49 PDT 2025
